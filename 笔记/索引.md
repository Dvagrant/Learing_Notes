## 索引的常见模型
- 哈希表
	- 优点：K-V结构，新增速度极快
	- 缺点：无序，范围查询只能通过全表扫描
- 有序数组
	- 优点：范围查询和点查（等值查询）速度都很快
	- 缺点：更新时必须挪动后方数据，开销较大
- 搜索树


---
## INNODB的索引模型
在 InnoDB 中，表都是根据主键顺序以索引的形式存放的，这种存储方式的表称为索引组织表。又因为前面我们提到的，InnoDB 使用了 B+ 树索引模型，所以数据都是存储在 B+ 树中的。

>N叉树的定义是一个节点可以存放N条数据，索引页的格式为KEY+POINT，指针大小都为6字节，若改变KEY的大小，在一个数据页（16KB）中所存放的数据量便可以更改，从而间接改变N叉树的N
> 
>也可以通过`innodb_page_size`对默认页大小进行更改

主键索引的叶子节点存的是整行数据（以页为单位）。在 InnoDB 里，主键索引也被称为聚簇索引`clustered index`

非主键索引的叶子节点内容是主键的值。在 InnoDB 里，非主键索引也被称为二级索引`secondary index`。***对于二级索引，会默认与主键做联合索引***

**主键索引和普通索引有什么区别**
- select * from T where ID = 1，主键查询，无需回表。
- select * from T where k = 1，普通索引查询，需要先到索引树上查找主键，再去数据结构中根据主键查询数据，需要回表。


---
## 索引维护

B+ 树为了维护索引有序性，在插入新值的时候需要做必要的维护。插入删除时有可能造成B+树的分裂和合并。

有自增主键时，由于是只追加的操作，不会造成B+树的分裂。

二级索引的叶子节点存放的是主键的值，所以因该选择占空间较小的字段作为主键。可节省索引文件的空间。

***重建普通索引，DROP 后  ADD 即可，但当重建主键索引时，之前的二级索引便失效了，如果索引文件较大，建议使用`alter table tablename engine = innodb`***

---
## 覆盖索引
当谓词条件（where 的条件）与映射（`projection`，即要查询的列）所需要的列都在都在索引上，则不需要二次回表，只在主键索引上就可以完成查询，称为索引覆盖


---
## 最左前缀原则
不只是索引的全部定义，只要满足最左前缀，就可以利用索引来加速检索。这个最左前缀可以是联合索引的最左 N 个字段，也可以是字符串索引的最左 M 个字符

---
## 索引下推
 MySQL 5.6 引入的索引下推优化（`index condition pushdown`)， 可以在索引遍历过程中，对索引中包含的字段先做判断，直接过滤掉不满足条件的记录，减少回表次数。