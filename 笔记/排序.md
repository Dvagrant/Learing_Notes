## 全字段排序

explain 中 Extra 字段，如果显示`Using filesort`表明语句需要进行排序。
MYSQL 给每个线程分配一块内存用于排序，称为`sort buffer`

需要的字段较少时，会根据主键取出所有查询行在`sort buffer`中排序，即全字段排序。

`sort_buffer_size`表明排序内存的大小，当内存过小时，需要利用磁盘空间来辅助排序。
>可以使用 `SET optimize_trace = 'enabled = on'`开启本线程的优化追踪。
>
>`SELECT * FROM information_schema.OPTIMIZER_TRACE\G`查看具体内容。其中`number_of_tmp_files`代表拆成的文件份数，例如4，表明将需要排序的文件分为4份，分别排序好后进行一次归并排序。
>
>`examined_rows`代表参与排序的行数。


---
## rowID排序
`max_length_for_sort_data`代表控制排序数据的长度，当要查询的字段很多时，数据长度超过此参数，就会采用 rowID 排序。即只对排序字段和主键ID在内存中排序，排好后利用主键ID回表查询所需全部字段。


## 利用索引避免排序
可以使用联合索引，使索引文件有序。当查询字段过少时，可以利用覆盖索引，无需回表，直接从索引文件中返回数据。

- `Using index`表明使用覆盖索引
- `Using filesort`表明需要进行额外的排序动作
- `Using index pushdown`表示使用了索引下推
- `Using where`表明本次查询需要根据谓词条件筛选过滤
- `Using temporary`表示需要使用临时表        